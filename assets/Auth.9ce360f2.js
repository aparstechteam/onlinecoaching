import{o as l,c,f as t,w as d,v as m,n as h,g as p}from"./vendor.45da7dae.js";import{_ as u}from"./logo.a27262e2.js";import{_ as f}from"./index.d83bca15.js";const g={name:"LoginFrom",beforeRouteEnter(e,o,s){if(!JSON.parse(localStorage.getItem("10msexam"))){s();return}s({path:"/"})},data(){return{examdata:null,phone:"01",user:null,attempt:0,loading:!1}},methods:{initializePage(){fetch("https://script.google.com/macros/s/AKfycbylTXudJbXrOvBQ2gqcWmvj0QuYhxcvbEotbSnRXp0EtbNpxx72inA5Fcq9P2dfseeX/exec?type=exams&id="+this.$route.params.exam_id).then(e=>e.json()).then(e=>{this.examdata=e})},async validatePayment(){if(this.attempt++,this.loading=!0,this.attempt<4){let e=this.phone.length,o="0"+this.phone.substring(e-10,e);try{let a=await(await fetch(`https://script.google.com/macros/s/AKfycbwcPMOtnHQWcjnr_SD8gxPYiQ1l9kZZ3Fwlrf2QzKX9auGKoBIIoWwZIYCKemq2bsO4/exec?prod_id=${this.$route.params.prod_id}&phone=${o}`)).json();a.purchased?(this.user=a.trans[0],this.insertRow()):(this.loading=!1,this.$swal({icon:"warning",title:"Wrong Credential",text:"Please try again with valid data"}))}catch{this.login_alert_msg="An Unexpected error occurred. Please try again later.";return}}else this.$swal({title:"Do u want to continue without valid info?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Continue"}).then(e=>{e.isConfirmed&&location.replace(this.examdata.exam.link)})},insertRow(){let{cust_id:e,name:o,prod_id:s,title:a}=this.user;fetch("https://script.google.com/macros/s/AKfycbzh8PMJhIenQbfayPDSffdsylmdu6SMTxuiB8gbvaOeGPCzZowqUe30JAGgR9TUmd2o/exec",{method:"POST",mode:"no-cors",cache:"no-cache",redirect:"follow",body:JSON.stringify({row:[e,o,a,s,this.$route.params.exam_id]})}).then(()=>{location.replace(this.examdata.exam.link)})}},created(){this.initializePage()}},_={key:0,class:"poppins min-h-screen gap-4 container mx-auto py-20"},x=t("div",{class:"my-5"},[t("img",{src:u,alt:"10minuteschool",class:"h-12 mx-auto"})],-1),y={class:"form-control max-w-md mx-auto"},b=t("label",{for:"",class:"label"},[t("span",{class:"label-text"},"Enter your phone Number")],-1),w={class:"my-5 text-center"},v={key:1,class:"py-20 text-center"},P=t("button",{class:"btn btn-circle loading"},null,-1),X=[P];function B(e,o,s,a,i,r){return i.examdata?(l(),c("div",_,[x,t("form",{onSubmit:o[1]||(o[1]=p((...n)=>r.validatePayment&&r.validatePayment(...n),["prevent"]))},[t("div",y,[b,d(t("input",{type:"tel",placeholder:"01XXXXXXXXX",required:"",name:"phone",class:"input input-bordered","onUpdate:modelValue":o[0]||(o[0]=n=>i.phone=n)},null,512),[[m,i.phone]])]),t("div",w,[t("button",{class:h(["btn",{loading:i.loading}])},"Enter",2)])],32)])):(l(),c("div",v,X))}var C=f(g,[["render",B]]);export{C as default};
